---
title: "Assignment04"
author: "Ruining Zheng & Yixuan Li"
format:
  html: 
    self-contained: true
editor: visual
---

```{r}

library(htmltools)
link_text <- "The data comes from World Bank"
url <- "https://data.worldbank.org/indicator/EN.ATM.CO2E.KT?view=chart"
hyperlink <- tags$a(href = url, target = "_blank", link_text)
html_print(hyperlink)
```

```{r, warning=FALSE}
library(readr)
library(tidyverse)
CO2_emission <- read_csv("data/CO2_emission.csv", show_col_types = FALSE)
Country_Code <- read.csv("data/Country_API.csv")
INDICATOR_CODE <- read.csv("data/Indicator_API.csv")
```

```{r}
# Plot 1
library(tidyverse)
year_amount <- CO2_emission %>%
  select(- Country_Code & - Indicator_Code & - Indicator_Name) %>%
  select(- matches("19[6-8]\\d")) %>%
  select(- "2021" & - "2020") %>%
  pivot_longer(
    cols = c("1990":"2019"),
    names_to = "Year",
    values_to = "Amount"
  ) %>%
  filter(Country_Name == "Total")
 
library(ggplot2)
year_amount %>%
ggplot() +
  geom_point(mapping = aes(x = Year, y = Amount)) +
  xlab("Year (from 1990-2019)") +
  ylab("Total Emission Amount")+
  labs(title = "Yearly CO2 Emission Amount from 1990 to 2019")
  
```

```{r}
# Plot 2
# We want to plot the emission amount percentage of China, France, Russia, United States and the UK in 2018.
library(tidyverse)
perminant_member <- CO2_emission %>%
  select(Country_Name, "2018") %>%
  filter(Country_Name == "Russian Federation" | Country_Name == "United States" | Country_Name == "United Kingdom" | Country_Name == "China" | Country_Name == "France") %>%
  rename(Amount = "2018")

perminant_member %>%
ggplot() +
  geom_col(mapping = aes(x = Country_Name, y = Amount, fill = Country_Name)) + 
  xlab("Perminant members") +
  ylab("Emission Amount in 2018") +
  labs(title = "CO2 Emisison Amount of Five Perminant Members in the UN Security Council in 2018")
  

```

```{r}
#Plot 3
```

```{r}
#Plot 4
```
